---
import * as Content from "astro:content"

import Header from "../components/header.astro"
import Footer from "../components/footer.astro"
import Metadata from "../components/common_metadata.astro"
import AppsList from "../components/apps_list.astro"

import categories from "../categories.json" with { type: "json" }

export async function getStaticPaths() {
	return categories.map(category => ({
		params: { category: category.slug }, props: { category },
})) }

let { category } = Astro.props

let apps = await Content.getCollection("metadata", ({ data }) => data.categories.includes(category.slug))
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="/common.css">
		<link rel="icon" href={ "/icons/" + category.slug + ".png" } type="image/png">

		<Metadata/>
		<title>{ category.name } - FF Apps Archive</title>
	</head>
	<body>
		<Header/>
		<main>
			<header>
				<img src={ "/icons/" + category.slug + ".png" } alt="" width="40" height="40">
				<h2>{ category.name }</h2>
			</header>
			<AppsList apps={ apps }/>
		</main>	
		<Footer/>
	</body>
</html>